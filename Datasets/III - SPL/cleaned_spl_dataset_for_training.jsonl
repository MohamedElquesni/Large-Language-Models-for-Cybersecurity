{"instruction":"Write a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Give me a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Develop a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Write a SPL query to detect excessive failed SMB logins indicating brute force.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4625| stats count by src_ip| where count > 20"}
{"instruction":"Design a SPL query to detect scheduled task creation by suspicious users.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4698| where like(Task_Name, \"%schtasks%\")| table _time, user, host, Task_Name"}
{"instruction":"Give me a SPL query to detect use of netstat and whoami in a short time window.","output":"index=windows sourcetype=WinEventLog:ProcessTracking EventCode=4688| where process_name IN (\"netstat.exe\", \"whoami.exe\")| stats count by host, user, process_name"}
{"instruction":"Design a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Produce a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Develop a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Create a SPL query to detect reverse shell connection attempts over TCP.","output":"index=network sourcetype=bro_conn| where dest_port IN (4444, 1337, 5555) AND protocol=\"tcp\"| table _time, src_ip, dest_ip, dest_port"}
{"instruction":"Produce a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Produce a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Design a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Create a SPL query to detect scheduled task creation by suspicious users.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4698| where like(Task_Name, \"%schtasks%\")| table _time, user, host, Task_Name"}
{"instruction":"Design a SPL query to detect use of netstat and whoami in a short time window.","output":"index=windows sourcetype=WinEventLog:ProcessTracking EventCode=4688| where process_name IN (\"netstat.exe\", \"whoami.exe\")| stats count by host, user, process_name"}
{"instruction":"Develop a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Give me a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Write a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Develop a SPL query to detect reverse shell connection attempts over TCP.","output":"index=network sourcetype=bro_conn| where dest_port IN (4444, 1337, 5555) AND protocol=\"tcp\"| table _time, src_ip, dest_ip, dest_port"}
{"instruction":"Write a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Give me a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Give me a SPL query to detect excessive failed SMB logins indicating brute force.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4625| stats count by src_ip| where count > 20"}
{"instruction":"Write a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Create a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Write a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Give me a SPL query to detect scheduled task creation by suspicious users.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4698| where like(Task_Name, \"%schtasks%\")| table _time, user, host, Task_Name"}
{"instruction":"Produce a SPL query to detect use of netstat and whoami in a short time window.","output":"index=windows sourcetype=WinEventLog:ProcessTracking EventCode=4688| where process_name IN (\"netstat.exe\", \"whoami.exe\")| stats count by host, user, process_name"}
{"instruction":"Produce a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Design a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Produce a SPL query to detect reverse shell connection attempts over TCP.","output":"index=network sourcetype=bro_conn| where dest_port IN (4444, 1337, 5555) AND protocol=\"tcp\"| table _time, src_ip, dest_ip, dest_port"}
{"instruction":"Develop a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Write a SPL query to detect use of netstat and whoami in a short time window.","output":"index=windows sourcetype=WinEventLog:ProcessTracking EventCode=4688| where process_name IN (\"netstat.exe\", \"whoami.exe\")| stats count by host, user, process_name"}
{"instruction":"Write a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Give me a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Design a SPL query to detect reverse shell connection attempts over TCP.","output":"index=network sourcetype=bro_conn| where dest_port IN (4444, 1337, 5555) AND protocol=\"tcp\"| table _time, src_ip, dest_ip, dest_port"}
{"instruction":"Produce a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Create a SPL query to detect excessive failed SMB logins indicating brute force.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4625| stats count by src_ip| where count > 20"}
{"instruction":"Give me a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Design a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Design a SPL query to detect excessive failed SMB logins indicating brute force.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4625| stats count by src_ip| where count > 20"}
{"instruction":"Design a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Give me a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Develop a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Develop a SPL query to detect scheduled task creation by suspicious users.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4698| where like(Task_Name, \"%schtasks%\")| table _time, user, host, Task_Name"}
{"instruction":"Develop a SPL query to detect excessive failed SMB logins indicating brute force.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4625| stats count by src_ip| where count > 20"}
{"instruction":"Produce a SPL query to detect scheduled task creation by suspicious users.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4698| where like(Task_Name, \"%schtasks%\")| table _time, user, host, Task_Name"}
{"instruction":"Give me a SPL query to detect reverse shell connection attempts over TCP.","output":"index=network sourcetype=bro_conn| where dest_port IN (4444, 1337, 5555) AND protocol=\"tcp\"| table _time, src_ip, dest_ip, dest_port"}
{"instruction":"Create a SPL query to detect use of netstat and whoami in a short time window.","output":"index=windows sourcetype=WinEventLog:ProcessTracking EventCode=4688| where process_name IN (\"netstat.exe\", \"whoami.exe\")| stats count by host, user, process_name"}
{"instruction":"Create a SPL query to detect DNS tunneling via long domain names.","output":"index=dns sourcetype=dns_logs| where len(query) > 50| stats count by query, src_ip"}
{"instruction":"Create a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Produce a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Design a SPL query to detect outbound HTTP GET requests to a suspicious IP address.","output":"index=network sourcetype=bro_http| where http_method=\"GET\" AND dest_ip=\"<SUSPICIOUS_IP>\"| table _time, src_ip, dest_ip, uri_path"}
{"instruction":"Develop a SPL query to detect credential dumping using lsass access by procdump.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where target_process=\"lsass.exe\" AND accessing_process=\"procdump.exe\"| table _time, user, host, accessing_process, target_process"}
{"instruction":"Create a SPL query to detect parent-child relationships where winword.exe spawns powershell.exe.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where parent_process_name=\"winword.exe\" AND process_name=\"powershell.exe\"| table _time, user, host, parent_process_name, process_name, command_line"}
{"instruction":"Create a SPL query to find suspicious registry modifications.","output":"index=sysmon sourcetype=Sysmon:RegistryEvent| where registry_key=\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"| table _time, user, host, registry_key, value"}
{"instruction":"Create a Splunk SPL query to detect when a PowerShell script is executed with base64-encoded content.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-PowerShell\/Operational EventCode=4104| where like(script_block_text, \"%-EncodedCommand%\")| table _time, user, host, script_block_text"}
{"instruction":"Create a SPL query to detect abnormal logon activity during non-working hours.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4624| eval hour=strftime(_time, \"%H\")| where hour < 6 OR hour > 20| stats count by user, host, hour"}
{"instruction":"Write a SPL query to detect insertion of new USB storage devices.","output":"index=windows sourcetype=WinEventLog:Microsoft-Windows-DriverFrameworks-UserMode\/Operational| where like(Message, \"%USB%\")| stats count by _time, user, host, Message"}
{"instruction":"Design a SPL query to detect rare processes per user over the past 7 days.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate earliest=-7d| stats dc(host) as host_count by user, process_name| where host_count = 1"}
{"instruction":"Give me a SPL query to identify external connections made after hours.","output":"index=network sourcetype=bro_conn| eval hour=strftime(_time, \"%H\")| where hour < 6 OR hour > 20 AND dest_ip!=\"internal\"| stats count by src_ip, dest_ip, hour"}
{"instruction":"Generate a SPL query to detect the use of certutil.exe, a dual-use tool.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where like(process_name, \"%certutil.exe%\")| table _time, user, host, process_name, command_line"}
{"instruction":"Produce a SPL query to find use of bitsadmin.exe for file transfer.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| where like(process_name, \"%bitsadmin.exe%\")| stats count by user, host, command_line"}
{"instruction":"Write a SPL query to detect when a user executes a process for the first time.","output":"index=sysmon sourcetype=Sysmon:ProcessCreate| stats earliest(_time) as first_seen by user, process_name| sort first_seen"}
{"instruction":"Create a SPL query to detect new service installations on Windows systems.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4697| table _time, user, service_name, service_file_name"}
{"instruction":"Give me a SPL query to detect users added to the administrators group.","output":"index=windows sourcetype=WinEventLog:Security EventCode=4728| stats count by user, target_user_name, host"}
{"instruction":"Create a SPL query to detect privilege escalation using token impersonation.","output":"index=sysmon sourcetype=Sysmon:ProcessAccess| where like(granted_access, \"%0x1FFFFF%\")| table _time, user, host, source_process, target_process"}
{"instruction":"Generate a Splunk SPL query to detect encoded PowerShell commands using FromBase64String.","output":"index=winlog EventCode=4104| where ScriptBlockText LIKE \"%FromBase64String%\"| table _time, user, host, ScriptBlockText"}
{"instruction":"Write an SPL query to find repeated failed RDP login attempts from the same IP within 10 minutes.","output":"index=winlog EventCode=4625| bucket _time span=10m| stats count by src_ip, _time| where count > 5"}
{"instruction":"Generate SPL to detect DNS requests to domains with more than 5 subdomain levels.","output":"index=dns sourcetype=\"dns_logs\"| eval subdomain_count = mvcount(split(domain, \".\"))| where subdomain_count > 5| table _time, src_ip, domain"}
{"instruction":"Write a Splunk query to detect creation of hidden scheduled tasks.","output":"index=winlog EventCode=4698| where Message LIKE \"%schtasks%\" AND (Message LIKE \"%\/IT%\" OR Message LIKE \"%Hidden%\")"}
{"instruction":"Generate a query to detect parent-child process pairs where MS Word spawns cmd.exe.","output":"index=sysmon EventCode=1| where parent_process_name=\"winword.exe\" AND process_name=\"cmd.exe\"| table _time, host, parent_process_name, process_name, CommandLine"}
{"instruction":"Write an SPL query to detect large outbound data transfers over non-standard ports.","output":"index=network sourcetype=flow_logs| where dest_port NOT IN (80, 443, 22)| stats sum(bytes_out) as total_out by src_ip, dest_port| where total_out > 10000000"}
{"instruction":"Generate a Splunk query to detect Mimikatz usage based on command-line patterns.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%mimikatz%\" OR Image LIKE \"%mimikatz%\"| table _time, host, CommandLine, ParentCommandLine"}
{"instruction":"Write an SPL query to find PowerShell using the 'Invoke-Expression' command.","output":"index=winlog EventCode=4104| where ScriptBlockText LIKE \"%Invoke-Expression%\"| table _time, user, host, ScriptBlockText"}
{"instruction":"Generate SPL to detect the creation of new user accounts on endpoints outside working hours.","output":"index=winlog EventCode=4720| eval hour=strftime(_time, \"%H\")| where hour < 8 OR hour > 18| table _time, host, user, Message"}
{"instruction":"Write a Splunk query to detect command-line use of 'net user' and 'net localgroup'.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%net user%\" OR CommandLine LIKE \"%net localgroup%\"| table _time, host, user, CommandLine"}
{"instruction":"Generate a Splunk SPL query to detect PowerShell using the 'IEX' alias for Invoke-Expression.","output":"index=winlog EventCode=4104| where ScriptBlockText LIKE \"%IEX%\"| table _time, user, host, ScriptBlockText"}
{"instruction":"Write an SPL query to detect usage of certutil for file downloads.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%certutil%\" AND CommandLine LIKE \"%http%\"| table _time, host, CommandLine"}
{"instruction":"Generate a Splunk SPL query to find use of encoded command-line arguments in PowerShell.","output":"index=winlog EventCode=4104| where ScriptBlockText LIKE \"%EncodedCommand%\"| table _time, user, ScriptBlockText"}
{"instruction":"Write an SPL query to detect rundll32.exe executing DLLs from temporary directories.","output":"index=sysmon EventCode=1| where Image=\"rundll32.exe\" AND CommandLine LIKE \"%Temp%\"| table _time, host, CommandLine"}
{"instruction":"Generate SPL to detect use of mshta.exe to execute remote scripts.","output":"index=sysmon EventCode=1| where Image=\"mshta.exe\" AND CommandLine LIKE \"http%\"| table _time, host, CommandLine"}
{"instruction":"Write a Splunk SPL query to detect creation of registry keys for persistence under Run path.","output":"index=winlog EventCode=4657| where ObjectName LIKE \"%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run%\"| table _time, host, user, ObjectName"}
{"instruction":"Generate SPL to detect LSASS memory access attempts indicating credential dumping.","output":"index=sysmon EventCode=10| where TargetImage=\"lsass.exe\"| table _time, host, SourceImage, TargetImage"}
{"instruction":"Write a Splunk SPL query to detect scheduled task creation using schtasks.exe.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%schtasks%\" AND CommandLine LIKE \"%\/create%\"| table _time, host, user, CommandLine"}
{"instruction":"Generate SPL to detect beaconing behavior with consistent time intervals from one host.","output":"index=network_logs| stats count by src_ip, dest_ip, _time| bin _time span=1m| stats count by src_ip, dest_ip| where count > 10"}
{"instruction":"Write SPL to detect multiple hosts communicating with a rare domain within 1 hour.","output":"index=dns sourcetype=\"dns_logs\"| stats dc(src_ip) as host_count by query| where host_count > 5| sort - host_count"}
{"instruction":"Generate SPL to detect use of whoami command.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%whoami%\"| table _time, user, host, CommandLine"}
{"instruction":"Write SPL to detect abnormal parent-child process pairs like Excel spawning cmd.","output":"index=sysmon EventCode=1| where parent_process_name=\"excel.exe\" AND process_name=\"cmd.exe\"| table _time, host, parent_process_name, process_name"}
{"instruction":"Generate a Splunk SPL query to detect usage of sc.exe to configure services.","output":"index=sysmon EventCode=1| where Image=\"sc.exe\" AND (CommandLine LIKE \"%config%\" OR CommandLine LIKE \"%create%\")| table _time, host, CommandLine"}
{"instruction":"Write SPL to detect use of PowerShell to add local administrators.","output":"index=winlog EventCode=4104| where ScriptBlockText LIKE \"%Add-LocalGroupMember%\" AND ScriptBlockText LIKE \"%Administrators%\"| table _time, user, ScriptBlockText"}
{"instruction":"Generate SPL to detect log clear operations using wevtutil.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%wevtutil%\" AND CommandLine LIKE \"%cl%\"| table _time, host, CommandLine"}
{"instruction":"Write SPL to detect network connections initiated by unusual binaries.","output":"index=sysmon EventCode=3| where Image NOT LIKE \"%\\Windows\\System32%\" AND dest_port != 443 AND dest_port != 80| table _time, Image, dest_ip, dest_port"}
{"instruction":"Generate SPL to detect base64-encoded payloads in command line.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%FromBase64String%\" OR CommandLine LIKE \"%EncodedCommand%\"| table _time, CommandLine"}
{"instruction":"Write SPL to detect execution of binaries from Downloads folder.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%\\Downloads\\%\"| table _time, host, CommandLine"}
{"instruction":"Generate SPL to detect multiple failed login attempts followed by a success.","output":"index=winlog sourcetype=\"Winlog:Security\" (EventCode=4625 OR EventCode=4624)| transaction user maxspan=10m| search EventCode=4625 AND EventCode=4624| table _time, user, host, EventCode"}
{"instruction":"Write SPL to detect use of encoded PowerShell and suspicious networking.","output":"index=sysmon EventCode=1| where CommandLine LIKE \"%EncodedCommand%\" AND (CommandLine LIKE \"%http%\" OR CommandLine LIKE \"%wget%\" OR CommandLine LIKE \"%curl%\")| table _time, host, CommandLine"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'registry_path' field","output":"index=* registry_path=*| timechart span=1h count by registry_path"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'http_method' field","output":"index=* http_method=*| regex http_method=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'sourcetype' field","output":"index=* sourcetype=*| regex sourcetype=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'action' field","output":"index=* action=*| bucket _time span=1h| stats avg(bytes_out) by _time, action"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'severity' field","output":"index=* severity=*| timechart span=1h count by severity"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'severity' field","output":"index=* severity=*| where like(severity, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'http_method' field","output":"index=* http_method=*| eval risk=if(match(http_method, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'action' field","output":"index=* action=*| stats count by action, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'eventcode' field","output":"index=* eventcode=*| timechart span=1h count by eventcode"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'command_line' field","output":"index=* command_line=*| timechart span=1h count by command_line"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'signature' field","output":"index=* signature=*| timechart span=1h count by signature"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'device_product' field","output":"index=* device_product=*| eval risk=if(match(device_product, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'http_method' field","output":"index=* http_method=*| eval risk=if(match(http_method, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'sourcetype' field","output":"index=* sourcetype=*| timechart span=1h count by sourcetype"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'index' field","output":"index=* index=*| regex index=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'src' field","output":"index=* src=*| timechart span=1h count by src"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'event_type' field","output":"index=* event_type=*| where like(event_type, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'dest' field","output":"index=* dest=*| where like(dest, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'image' field","output":"index=* image=*| regex image=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'src' field","output":"index=* src=*| regex src=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'signature' field","output":"index=* signature=*| where like(signature, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'description' field","output":"index=* description=*| eval risk=if(match(description, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'url' field","output":"index=* url=*| stats count by url, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'http_method' field","output":"index=* http_method=*| stats count by http_method, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'sourcetype' field","output":"index=* sourcetype=*| regex sourcetype=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'http_method' field","output":"index=* http_method=*| stats count by http_method, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'registry_path' field","output":"index=* registry_path=*| timechart span=1h count by registry_path"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'severity' field","output":"index=* severity=*| stats count by severity, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'dest' field","output":"index=* dest=*| where like(dest, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'src' field","output":"index=* src=*| bucket _time span=1h| stats avg(bytes_out) by _time, src"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'sourcetype' field","output":"index=* sourcetype=*| regex sourcetype=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'sourcetype' field","output":"index=* sourcetype=*| stats count by sourcetype, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'user' field","output":"index=* user=*| regex user=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'command_line' field","output":"index=* command_line=*| timechart span=1h count by command_line"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'image' field","output":"index=* image=*| timechart span=1h count by image"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'src' field","output":"index=* src=*| where like(src, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'host' field","output":"index=* host=*| regex host=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'sourcetype' field","output":"index=* sourcetype=*| stats count by sourcetype, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'user_agent' field","output":"index=* user_agent=*| where like(user_agent, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'protocol' field","output":"index=* protocol=*| regex protocol=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'severity' field","output":"index=* severity=*| eval risk=if(match(severity, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'protocol' field","output":"index=* protocol=*| regex protocol=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'file_path' field","output":"index=* file_path=*| timechart span=1h count by file_path"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'protocol' field","output":"index=* protocol=*| stats count by protocol, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'protocol' field","output":"index=* protocol=*| eval risk=if(match(protocol, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'source' field","output":"index=* source=*| bucket _time span=1h| stats avg(bytes_out) by _time, source"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'action' field","output":"index=* action=*| timechart span=1h count by action"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'image' field","output":"index=* image=*| bucket _time span=1h| stats avg(bytes_out) by _time, image"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'severity' field","output":"index=* severity=*| regex severity=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'http_method' field","output":"index=* http_method=*| eval risk=if(match(http_method, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'http_method' field","output":"index=* http_method=*| stats count by http_method, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'image' field","output":"index=* image=*| bucket _time span=1h| stats avg(bytes_out) by _time, image"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'object_name' field","output":"index=* object_name=*| bucket _time span=1h| stats avg(bytes_out) by _time, object_name"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'user' field","output":"index=* user=*| eval risk=if(match(user, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'image' field","output":"index=* image=*| where like(image, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'action' field","output":"index=* action=*| bucket _time span=1h| stats avg(bytes_out) by _time, action"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'object_name' field","output":"index=* object_name=*| bucket _time span=1h| stats avg(bytes_out) by _time, object_name"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'parent_process' field","output":"index=* parent_process=*| stats count by parent_process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'dest' field","output":"index=* dest=*| eval risk=if(match(dest, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'action' field","output":"index=* action=*| bucket _time span=1h| stats avg(bytes_out) by _time, action"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats avg(bytes_out) by _time, user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'severity' field","output":"index=* severity=*| timechart span=1h count by severity"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'user' field","output":"index=* user=*| eval risk=if(match(user, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'user_agent' field","output":"index=* user_agent=*| regex user_agent=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'severity' field","output":"index=* severity=*| timechart span=1h count by severity"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'device_product' field","output":"index=* device_product=*| eval risk=if(match(device_product, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'user_agent' field","output":"index=* user_agent=*| where like(user_agent, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'action' field","output":"index=* action=*| stats count by action, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'user' field","output":"index=* user=*| eval risk=if(match(user, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'user_agent' field","output":"index=* user_agent=*| eval risk=if(match(user_agent, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'src' field","output":"index=* src=*| stats count by src, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'category' field","output":"index=* category=*| timechart span=1h count by category"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'host' field","output":"index=* host=*| regex host=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'action' field","output":"index=* action=*| stats count by action, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'event_type' field","output":"index=* event_type=*| where like(event_type, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'description' field","output":"index=* description=*| where like(description, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'parent_process' field","output":"index=* parent_process=*| timechart span=1h count by parent_process"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'source' field","output":"index=* source=*| regex source=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'severity' field","output":"index=* severity=*| where like(severity, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'http_method' field","output":"index=* http_method=*| eval risk=if(match(http_method, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'severity' field","output":"index=* severity=*| stats count by severity, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'category' field","output":"index=* category=*| stats count by category, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'image' field","output":"index=* image=*| where like(image, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'http_method' field","output":"index=* http_method=*| stats count by http_method, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'http_method' field","output":"index=* http_method=*| bucket _time span=1h| stats avg(bytes_out) by _time, http_method"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'action' field","output":"index=* action=*| stats count by action, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'event_type' field","output":"index=* event_type=*| where like(event_type, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'src' field","output":"index=* src=*| regex src=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'dest' field","output":"index=* dest=*| timechart span=1h count by dest"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'source' field","output":"index=* source=*| regex source=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'action' field","output":"index=* action=*| timechart span=1h count by action"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'severity' field","output":"index=* severity=*| stats count by severity, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'process' field","output":"index=* process=*| regex process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'sourcetype' field","output":"index=* sourcetype=*| regex sourcetype=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'src' field","output":"index=* src=*| bucket _time span=1h| stats avg(bytes_out) by _time, src"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'index' field","output":"index=* index=*| regex index=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'user_agent' field","output":"index=* user_agent=*| where like(user_agent, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'user_agent' field","output":"index=* user_agent=*| eval risk=if(match(user_agent, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'index' field","output":"index=* index=*| timechart span=1h count by index"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'image' field","output":"index=* image=*| where like(image, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'sourcetype' field","output":"index=* sourcetype=*| bucket _time span=1h| stats avg(bytes_out) by _time, sourcetype"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'category' field","output":"index=* category=*| stats count by category, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'action' field","output":"index=* action=*| bucket _time span=1h| stats avg(bytes_out) by _time, action"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'file_path' field","output":"index=* file_path=*| regex file_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'src' field","output":"index=* src=*| stats count by src, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'signature' field","output":"index=* signature=*| where like(signature, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'user' field","output":"index=* user=*| eval risk=if(match(user, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'http_method' field","output":"index=* http_method=*| bucket _time span=1h| stats avg(bytes_out) by _time, http_method"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'signature' field","output":"index=* signature=*| timechart span=1h count by signature"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'host' field","output":"index=* host=*| regex host=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'parent_process' field","output":"index=* parent_process=*| bucket _time span=1h| stats avg(bytes_out) by _time, parent_process"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'parent_process' field","output":"index=* parent_process=*| bucket _time span=1h| stats avg(bytes_out) by _time, parent_process"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'sourcetype' field","output":"index=* sourcetype=*| stats count by sourcetype, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'action' field","output":"index=* action=*| timechart span=1h count by action"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'dest' field","output":"index=* dest=*| where like(dest, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'action' field","output":"index=* action=*| regex action=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'action' field","output":"index=* action=*| regex action=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'process' field","output":"index=* process=*| regex process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'device_product' field","output":"index=* device_product=*| eval risk=if(match(device_product, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'dest' field","output":"index=* dest=*| eval risk=if(match(dest, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'description' field","output":"index=* description=*| eval risk=if(match(description, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'src' field","output":"index=* src=*| bucket _time span=1h| stats avg(bytes_out) by _time, src"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'parent_process' field","output":"index=* parent_process=*| bucket _time span=1h| stats avg(bytes_out) by _time, parent_process"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'device_product' field","output":"index=* device_product=*| eval risk=if(match(device_product, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'sourcetype' field","output":"index=* sourcetype=*| bucket _time span=1h| stats avg(bytes_out) by _time, sourcetype"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'action' field","output":"index=* action=*| bucket _time span=1h| stats avg(bytes_out) by _time, action"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'parent_process' field","output":"index=* parent_process=*| stats count by parent_process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'object_name' field","output":"index=* object_name=*| where like(object_name, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'severity' field","output":"index=* severity=*| eval risk=if(match(severity, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'event_type' field","output":"index=* event_type=*| where like(event_type, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'source' field","output":"index=* source=*| bucket _time span=1h| stats avg(bytes_out) by _time, source"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'index' field","output":"index=* index=*| timechart span=1h count by index"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'registry_path' field","output":"index=* registry_path=*| timechart span=1h count by registry_path"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'eventcode' field","output":"index=* eventcode=*| timechart span=1h count by eventcode"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'sourcetype' field","output":"index=* sourcetype=*| where like(sourcetype, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'action' field","output":"index=* action=*| regex action=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats avg(bytes_out) by _time, user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'device_product' field","output":"index=* device_product=*| timechart span=1h count by device_product"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'index' field","output":"index=* index=*| regex index=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'user' field","output":"index=* user=*| regex user=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'parent_process' field","output":"index=* parent_process=*| stats count by parent_process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'parent_process' field","output":"index=* parent_process=*| bucket _time span=1h| stats avg(bytes_out) by _time, parent_process"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'sourcetype' field","output":"index=* sourcetype=*| where like(sourcetype, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'image' field","output":"index=* image=*| timechart span=1h count by image"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'http_method' field","output":"index=* http_method=*| bucket _time span=1h| stats avg(bytes_out) by _time, http_method"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'category' field","output":"index=* category=*| stats count by category, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'severity' field","output":"index=* severity=*| where like(severity, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'eventcode' field","output":"index=* eventcode=*| timechart span=1h count by eventcode"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'status' field","output":"index=* status=*| eval risk=if(match(status, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'protocol' field","output":"index=* protocol=*| stats count by protocol, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'description' field","output":"index=* description=*| where like(description, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user' field","output":"index=* user=*| regex user=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'parent_process' field","output":"index=* parent_process=*| timechart span=1h count by parent_process"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'src' field","output":"index=* src=*| timechart span=1h count by src"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats avg(bytes_out) by _time, user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'dest' field","output":"index=* dest=*| timechart span=1h count by dest"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'protocol' field","output":"index=* protocol=*| timechart span=1h count by protocol"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'url' field","output":"index=* url=*| stats count by url, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'source' field","output":"index=* source=*| bucket _time span=1h| stats avg(bytes_out) by _time, source"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'http_method' field","output":"index=* http_method=*| bucket _time span=1h| stats avg(bytes_out) by _time, http_method"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'action' field","output":"index=* action=*| stats count by action, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'file_path' field","output":"index=* file_path=*| regex file_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'src' field","output":"index=* src=*| stats count by src, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'description' field","output":"index=* description=*| timechart span=1h count by description"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'description' field","output":"index=* description=*| where like(description, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'sourcetype' field","output":"index=* sourcetype=*| timechart span=1h count by sourcetype"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'action' field","output":"index=* action=*| timechart span=1h count by action"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'description' field","output":"index=* description=*| timechart span=1h count by description"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'user_agent' field","output":"index=* user_agent=*| bucket _time span=1h| stats avg(bytes_out) by _time, user_agent"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'src' field","output":"index=* src=*| regex src=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'source' field","output":"index=* source=*| regex source=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'sourcetype' field","output":"index=* sourcetype=*| bucket _time span=1h| stats avg(bytes_out) by _time, sourcetype"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'severity' field","output":"index=* severity=*| eval risk=if(match(severity, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'src' field","output":"index=* src=*| timechart span=1h count by src"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'device_product' field","output":"index=* device_product=*| bucket _time span=1h| stats avg(bytes_out) by _time, device_product"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'image' field","output":"index=* image=*| regex image=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'object_name' field","output":"index=* object_name=*| bucket _time span=1h| stats avg(bytes_out) by _time, object_name"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'protocol' field","output":"index=* protocol=*| stats count by protocol, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'eventcode' field","output":"index=* eventcode=*| timechart span=1h count by eventcode"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats avg(bytes_out) by _time, user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'device_product' field","output":"index=* device_product=*| timechart span=1h count by device_product"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'index' field","output":"index=* index=*| regex index=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'user_agent' field","output":"index=* user_agent=*| eval risk=if(match(user_agent, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'signature' field","output":"index=* signature=*| where like(signature, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'object_name' field","output":"index=* object_name=*| where like(object_name, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'protocol' field","output":"index=* protocol=*| bucket _time span=1h| stats avg(bytes_out) by _time, protocol"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'user' field","output":"index=* user=*| eval risk=if(match(user, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'src' field","output":"index=* src=*| regex src=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'source' field","output":"index=* source=*| regex source=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'protocol' field","output":"index=* protocol=*| stats count by protocol, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'severity' field","output":"index=* severity=*| timechart span=1h count by severity"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'file_path' field","output":"index=* file_path=*| eval risk=if(match(file_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'protocol' field","output":"index=* protocol=*| eval risk=if(match(protocol, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user_agent' field","output":"index=* user_agent=*| regex user_agent=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'registry_path' field","output":"index=* registry_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, registry_path"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'object_name' field","output":"index=* object_name=*| bucket _time span=1h| stats avg(bytes_out) by _time, object_name"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'sourcetype' field","output":"index=* sourcetype=*| regex sourcetype=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'eventcode' field","output":"index=* eventcode=*| bucket _time span=1h| stats avg(bytes_out) by _time, eventcode"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'user_agent' field","output":"index=* user_agent=*| where like(user_agent, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'dest' field","output":"index=* dest=*| stats count by dest, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user_agent' field","output":"index=* user_agent=*| eval risk=if(match(user_agent, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'description' field","output":"index=* description=*| eval risk=if(match(description, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'user' field","output":"index=* user=*| where like(user, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'description' field","output":"index=* description=*| stats count by description, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'severity' field","output":"index=* severity=*| eval risk=if(match(severity, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'index' field","output":"index=* index=*| regex index=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'description' field","output":"index=* description=*| where like(description, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'image' field","output":"index=* image=*| bucket _time span=1h| stats avg(bytes_out) by _time, image"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'severity' field","output":"index=* severity=*| eval risk=if(match(severity, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'signature' field","output":"index=* signature=*| where like(signature, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'description' field","output":"index=* description=*| eval risk=if(match(description, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'command_line' field","output":"index=* command_line=*| timechart span=1h count by command_line"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'action' field","output":"index=* action=*| regex action=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'action' field","output":"index=* action=*| timechart span=1h count by action"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'file_path' field","output":"index=* file_path=*| timechart span=1h count by file_path"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'event_type' field","output":"index=* event_type=*| regex event_type=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'user' field","output":"index=* user=*| timechart span=1h count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'event_type' field","output":"index=* event_type=*| timechart span=1h count by event_type"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'action' field","output":"index=* action=*| regex action=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'url' field","output":"index=* url=*| regex url=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'http_method' field","output":"index=* http_method=*| eval risk=if(match(http_method, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'protocol' field","output":"index=* protocol=*| regex protocol=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'parent_process' field","output":"index=* parent_process=*| timechart span=1h count by parent_process"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'status' field","output":"index=* status=*| bucket _time span=1h| stats avg(bytes_out) by _time, status"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'host' field","output":"index=* host=*| stats count by host, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'host' field","output":"index=* host=*| regex host=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'process' field","output":"index=* process=*| regex process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'source' field","output":"index=* source=*| bucket _time span=1h| stats avg(bytes_out) by _time, source"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'protocol' field","output":"index=* protocol=*| regex protocol=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'signature' field","output":"index=* signature=*| where like(signature, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'severity' field","output":"index=* severity=*| stats count by severity, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'source' field","output":"index=* source=*| timechart span=1h count by source"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'dest' field","output":"index=* dest=*| stats count by dest, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'file_path' field","output":"index=* file_path=*| stats count by file_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'severity' field","output":"index=* severity=*| where like(severity, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'url' field","output":"index=* url=*| bucket _time span=1h| stats avg(bytes_out) by _time, url"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'registry_path' field","output":"index=* registry_path=*| stats count by registry_path, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'dest' field","output":"index=* dest=*| eval risk=if(match(dest, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'category' field","output":"index=* category=*| regex category=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'user' field","output":"index=* user=*| regex user=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| timechart span=1h count by registry_path"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'src' field","output":"index=* src=*| where like(src, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'protocol' field","output":"index=* protocol=*| where like(protocol, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'dest' field","output":"index=* dest=*| eval risk=if(match(dest, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'category' field","output":"index=* category=*| bucket _time span=1h| stats avg(bytes_out) by _time, category"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'file_path' field","output":"index=* file_path=*| timechart span=1h count by file_path"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'command_line' field","output":"index=* command_line=*| timechart span=1h count by command_line"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'dest' field","output":"index=* dest=*| stats count by dest, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'user_agent' field","output":"index=* user_agent=*| regex user_agent=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'signature' field","output":"index=* signature=*| regex signature=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'image' field","output":"index=* image=*| where like(image, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'parent_process' field","output":"index=* parent_process=*| timechart span=1h count by parent_process"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'status' field","output":"index=* status=*| timechart span=1h count by status"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'sourcetype' field","output":"index=* sourcetype=*| bucket _time span=1h| stats avg(bytes_out) by _time, sourcetype"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'event_type' field","output":"index=* event_type=*| eval risk=if(match(event_type, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'url' field","output":"index=* url=*| eval risk=if(match(url, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'process' field","output":"index=* process=*| timechart span=1h count by process"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'command_line' field","output":"index=* command_line=*| bucket _time span=1h| stats avg(bytes_out) by _time, command_line"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'device_product' field","output":"index=* device_product=*| eval risk=if(match(device_product, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'index' field","output":"index=* index=*| stats count by index, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'process' field","output":"index=* process=*| regex process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'image' field","output":"index=* image=*| bucket _time span=1h| stats avg(bytes_out) by _time, image"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'object_name' field","output":"index=* object_name=*| bucket _time span=1h| stats avg(bytes_out) by _time, object_name"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'image' field","output":"index=* image=*| eval risk=if(match(image, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'src' field","output":"index=* src=*| where like(src, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'category' field","output":"index=* category=*| stats count by category, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'dest' field","output":"index=* dest=*| regex dest=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'process' field","output":"index=* process=*| where like(process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'dest' field","output":"index=* dest=*| stats count by dest, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'description' field","output":"index=* description=*| eval risk=if(match(description, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'event_type' field","output":"index=* event_type=*| bucket _time span=1h| stats avg(bytes_out) by _time, event_type"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'process' field","output":"index=* process=*| stats count by process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'protocol' field","output":"index=* protocol=*| stats count by protocol, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'host' field","output":"index=* host=*| bucket _time span=1h| stats avg(bytes_out) by _time, host"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'file_path' field","output":"index=* file_path=*| where like(file_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'protocol' field","output":"index=* protocol=*| timechart span=1h count by protocol"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'src' field","output":"index=* src=*| bucket _time span=1h| stats avg(bytes_out) by _time, src"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'src' field","output":"index=* src=*| where like(src, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'command_line' field","output":"index=* command_line=*| regex command_line=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'sourcetype' field","output":"index=* sourcetype=*| where like(sourcetype, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'image' field","output":"index=* image=*| where like(image, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'object_name' field","output":"index=* object_name=*| eval risk=if(match(object_name, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'category' field","output":"index=* category=*| timechart span=1h count by category"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'parent_process' field","output":"index=* parent_process=*| stats count by parent_process, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'source' field","output":"index=* source=*| regex source=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'signature' field","output":"index=* signature=*| stats count by signature, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'description' field","output":"index=* description=*| bucket _time span=1h| stats avg(bytes_out) by _time, description"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'action' field","output":"index=* action=*| where like(action, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'source' field","output":"index=* source=*| eval risk=if(match(source, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'device_product' field","output":"index=* device_product=*| timechart span=1h count by device_product"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'user_agent' field","output":"index=* user_agent=*| stats count by user_agent, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'index' field","output":"index=* index=*| eval risk=if(match(index, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'http_method' field","output":"index=* http_method=*| where like(http_method, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'severity' field","output":"index=* severity=*| stats count by severity, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'http_method' field","output":"index=* http_method=*| regex http_method=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'signature' field","output":"index=* signature=*| eval risk=if(match(signature, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'device_product' field","output":"index=* device_product=*| where like(device_product, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'protocol' field","output":"index=* protocol=*| timechart span=1h count by protocol"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'url' field","output":"index=* url=*| stats count by url, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'image' field","output":"index=* image=*| regex image=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'eventcode' field","output":"index=* eventcode=*| stats count by eventcode, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'sourcetype' field","output":"index=* sourcetype=*| bucket _time span=1h| stats avg(bytes_out) by _time, sourcetype"}
{"instruction":"Write a Splunk SPL query to track privilege escalation via service abuse using the 'process' field","output":"index=* process=*| eval risk=if(match(process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'http_method' field","output":"index=* http_method=*| bucket _time span=1h| stats avg(bytes_out) by _time, http_method"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'sourcetype' field","output":"index=* sourcetype=*| where like(sourcetype, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify suspicious parent-child process relationships using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'category' field","output":"index=* category=*| where like(category, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'dest' field","output":"index=* dest=*| eval risk=if(match(dest, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'parent_process' field","output":"index=* parent_process=*| eval risk=if(match(parent_process, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'sourcetype' field","output":"index=* sourcetype=*| eval risk=if(match(sourcetype, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'status' field","output":"index=* status=*| regex status=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'image' field","output":"index=* image=*| regex image=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'host' field","output":"index=* host=*| where like(host, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'status' field","output":"index=* status=*| stats count by status, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'index' field","output":"index=* index=*| bucket _time span=1h| stats avg(bytes_out) by _time, index"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'source' field","output":"index=* source=*| where like(source, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'parent_process' field","output":"index=* parent_process=*| bucket _time span=1h| stats avg(bytes_out) by _time, parent_process"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'eventcode' field","output":"index=* eventcode=*| regex eventcode=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'registry_path' field","output":"index=* registry_path=*| regex registry_path=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'severity' field","output":"index=* severity=*| regex severity=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'severity' field","output":"index=* severity=*| regex severity=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'command_line' field","output":"index=* command_line=*| where like(command_line, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'object_name' field","output":"index=* object_name=*| stats count by object_name, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'process' field","output":"index=* process=*| bucket _time span=1h| stats avg(bytes_out) by _time, process"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect usage of PowerShell encoded commands using the 'object_name' field","output":"index=* object_name=*| where like(object_name, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'http_method' field","output":"index=* http_method=*| timechart span=1h count by http_method"}
{"instruction":"Write a Splunk SPL query to detect Mimikatz credential dumping using the 'eventcode' field","output":"index=* eventcode=*| where like(eventcode, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'image' field","output":"index=* image=*| stats count by image, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'severity' field","output":"index=* severity=*| timechart span=1h count by severity"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'object_name' field","output":"index=* object_name=*| regex object_name=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'protocol' field","output":"index=* protocol=*| eval risk=if(match(protocol, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'severity' field","output":"index=* severity=*| bucket _time span=1h| stats avg(bytes_out) by _time, severity"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect file uploads to public cloud services using the 'status' field","output":"index=* status=*| where like(status, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to detect GCP key creation events using the 'command_line' field","output":"index=* command_line=*| stats count by command_line, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'user_agent' field","output":"index=* user_agent=*| timechart span=1h count by user_agent"}
{"instruction":"Write a Splunk SPL query to monitor excessive file reads by one user using the 'eventcode' field","output":"index=* eventcode=*| eval risk=if(match(eventcode, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'command_line' field","output":"index=* command_line=*| timechart span=1h count by command_line"}
{"instruction":"Write a Splunk SPL query to track access to HR file shares using the 'parent_process' field","output":"index=* parent_process=*| where like(parent_process, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify tampering with scheduled tasks using the 'dest' field","output":"index=* dest=*| bucket _time span=1h| stats avg(bytes_out) by _time, dest"}
{"instruction":"Write a Splunk SPL query to identify base64 strings in HTTP POST bodies using the 'user' field","output":"index=* user=*| stats count by user, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect email forwarding rule creation using the 'url' field","output":"index=* url=*| where like(url, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'file_path' field","output":"index=* file_path=*| bucket _time span=1h| stats avg(bytes_out) by _time, file_path"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'signature' field","output":"index=* signature=*| bucket _time span=1h| stats avg(bytes_out) by _time, signature"}
{"instruction":"Write a Splunk SPL query to track LSASS memory access using the 'object_name' field","output":"index=* object_name=*| timechart span=1h count by object_name"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'parent_process' field","output":"index=* parent_process=*| regex parent_process=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect DNS tunneling attempts using the 'http_method' field","output":"index=* http_method=*| stats count by http_method, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to detect beaconing intervals in DNS traffic using the 'registry_path' field","output":"index=* registry_path=*| where like(registry_path, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to monitor changes to registry autorun keys using the 'category' field","output":"index=* category=*| eval risk=if(match(category, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'source' field","output":"index=* source=*| stats count by source, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'host' field","output":"index=* host=*| timechart span=1h count by host"}
{"instruction":"Write a Splunk SPL query to track deletion of event logs using the 'src' field","output":"index=* src=*| eval risk=if(match(src, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'description' field","output":"index=* description=*| regex description=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to identify printing of sensitive documents using the 'device_product' field","output":"index=* device_product=*| regex device_product=\".*(cmd\\.exe|powershell).*\"| stats count by host"}
{"instruction":"Write a Splunk SPL query to detect use of temporary cloud credentials using the 'registry_path' field","output":"index=* registry_path=*| eval risk=if(match(registry_path, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor AWS IAM role changes using the 'index' field","output":"index=* index=*| where like(index, \"%admin%\")| stats count by user"}
{"instruction":"Write a Splunk SPL query to identify new IPs contacted over HTTPS using the 'url' field","output":"index=* url=*| timechart span=1h count by url"}
{"instruction":"Write a Splunk SPL query to detect brute force login attempts using the 'event_type' field","output":"index=* event_type=*| stats count by event_type, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'src' field","output":"index=* src=*| stats count by src, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to monitor long-duration TCP connections using the 'host' field","output":"index=* host=*| eval risk=if(match(host, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'command_line' field","output":"index=* command_line=*| eval risk=if(match(command_line, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to monitor outbound FTP uploads using the 'signature' field","output":"index=* signature=*| timechart span=1h count by signature"}
{"instruction":"Write a Splunk SPL query to track spikes in outbound bandwidth using the 'action' field","output":"index=* action=*| eval risk=if(match(action, \"(?i)admin|root\"), 5, 1)| stats sum(risk) by user"}
{"instruction":"Write a Splunk SPL query to detect unsigned binary execution using the 'device_product' field","output":"index=* device_product=*| stats count by device_product, user| sort - count| head 10"}
{"instruction":"Write a Splunk SPL query to track Azure login anomalies using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats avg(bytes_out) by _time, user"}
{"instruction":"Write a Splunk SPL query to correlate failed logins with successful logins by the same user using the 'user' field","output":"index=* user=*| bucket _time span=1h| stats dc(dest_ip) as unique_dests, sum(bytes_out) as total_out by user| where unique_dests > 10 and total_out > 1000000"}
{"instruction":"Write a Splunk SPL query to join network traffic with threat intel IP list using lookup using the 'sourcetype' field","output":"index=* sourcetype=*| stats count by user| lookup user_roles user OUTPUT role| where role=\"admin\""}
{"instruction":"Write a Splunk SPL query to correlate file modifications with process executions using transaction using the 'host' field","output":"index=* host=*| stats count by src_ip| lookup geo_ip_lookup ip as src_ip OUTPUT country| where country=\"Russia\""}
{"instruction":"Write a Splunk SPL query to detect lateral movement by joining authentication and process creation logs using the 'image' field","output":"index=* image=*| lookup threat_ip_lookup ip as image OUTPUT category| stats count by category"}
{"instruction":"Write a Splunk SPL query to use lookup to enrich IPs with geolocation data using the 'event_type' field","output":"index=* event_type=*| stats count(eval(status=\"fail\")) as failed, count(eval(status=\"success\")) as success by user| eval ratio=round(failed\/(success+1),2)| where ratio > 0.5"}
{"instruction":"Write a Splunk SPL query to lookup usernames against asset inventory to find unmanaged devices using the 'action' field","output":"index=* action=*| transaction user startswith=eventcode=4624 endswith=eventcode=4625| stats count by user"}
{"instruction":"Write a Splunk SPL query to use CSV lookup to identify blacklisted domains in DNS logs using the 'object_name' field","output":"index=* object_name=*| stats count by user| lookup user_roles user OUTPUT role| where role=\"admin\""}
{"instruction":"Write a Splunk SPL query to enrich authentication logs with user roles using lookup table using the 'category' field","output":"index=* category=*| transaction user startswith=eventcode=4624 endswith=eventcode=4625| stats count by user"}
{"instruction":"Write a Splunk SPL query to assign risk scores to users based on multiple failed login attempts using the 'category' field","output":"index=* category=*| stats count by src_ip| lookup geo_ip_lookup ip as src_ip OUTPUT country| where country=\"Russia\""}
{"instruction":"Write a Splunk SPL query to flag processes using eval and case conditions based on command-line flags using the 'process' field","output":"index=* process=*| stats count by src_ip| lookup geo_ip_lookup ip as src_ip OUTPUT country| where country=\"Russia\""}
{"instruction":"Write a Splunk SPL query to score endpoints by number of unique destinations contacted and amount of data transferred using the 'source' field","output":"index=* source=*| bucket _time span=1h| stats dc(dest_ip) as unique_dests, sum(bytes_out) as total_out by user| where unique_dests > 10 and total_out > 1000000"}
{"instruction":"Write a Splunk SPL query to detect exfiltration based on combination of rare domain access and large HTTP POSTs using the 'protocol' field","output":"index=* protocol=*| stats count by src_ip| lookup geo_ip_lookup ip as src_ip OUTPUT country| where country=\"Russia\""}
{"instruction":"Write a Splunk SPL query to chain stats and top commands to find users with most failed logins per host using the 'source' field","output":"index=* source=*| lookup threat_ip_lookup ip as source OUTPUT category| stats count by category"}
{"instruction":"Write a Splunk SPL query to detect privilege escalation with chained eval and where clauses using the 'description' field","output":"index=* description=*| stats count by src_ip| lookup geo_ip_lookup ip as src_ip OUTPUT country| where country=\"Russia\""}
